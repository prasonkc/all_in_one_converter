<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Converter</title>
    <link rel="stylesheet" href="../static/css/sty2e.css">
</head>
<body>
    <h1>Image Converter</h1>
    <div class="container">
        <div class="left-side">
            <label class="upload-box" for="imageInput">
                Drop or Click to Browse
                <input type="file" accept="image/*" id="imageInput" style="display: none;">
            </label>
        </div>
        <div class="right-side">
            <select id="formatSelect">
                <option value="png">PNG</option>
                <option value="jpeg">JPEG</option>
                <option value="webp">WEBP</option>
                <!-- Add more format options here -->
            </select>
            <button id="convertBtn" style="display: none;" onclick="convertImage()">Convert</button>
            <button id="downloadBtn" style="display: none;" onclick="downloadConvertedImage()">Download</button>
            <img id="preview" alt="">
        </div>
    </div>
    <script>
        let convertedImageBlob = null;

        function convertImage() {
            const formatSelect = document.getElementById('formatSelect');
            const downloadBtn = document.getElementById('downloadBtn');
            const preview = document.getElementById('preview');

            const selectedFormat = formatSelect.value;

            // Simulate conversion by setting a timeout
            setTimeout(() => {
                // Simulate conversion completion
                // Here you would actually convert the image using a server or some library
                downloadBtn.style.display = 'block';
                preview.style.display = 'block';
                preview.src = URL.createObjectURL(convertedImageBlob);
                convertedImageBlob = new Blob([convertedImageBlob], { type: 'image/' + selectedFormat });
            }, 3000); // Simulated conversion time

            // You can perform actual conversion using server APIs or libraries here
        }

        function downloadConvertedImage() {
            if (convertedImageBlob) {
                const a = document.createElement('a');
                a.href = URL.createObjectURL(convertedImageBlob);
                a.download = 'converted_image.png'; // Change the filename as needed
                a.click();
            }
        }

        const uploadBox = document.querySelector('.upload-box');
        const imageInput = document.getElementById('imageInput');

        uploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadBox.style.border = '2px dashed #007bff';
        });

        uploadBox.addEventListener('dragleave', () => {
            uploadBox.style.border = '2px dashed #007bff';
        });

        uploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadBox.style.border = '2px dashed #007bff';
            convertedImageBlob = e.dataTransfer.files[0];
            document.getElementById('convertBtn').style.display = 'block';
        });

        uploadBox.addEventListener('click', () => {
            imageInput.click();
        });

        imageInput.addEventListener('change', () => {
            convertedImageBlob = imageInput.files[0];
            document.getElementById('convertBtn').style.display = 'block';
        });
    </script>
</body>
</html>
